<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartPark Pro | Advanced Parking Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-main: #0a0c10;
            --bg-card: rgba(23, 27, 34, 0.8);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-main);
            color: #f3f4f6;
        }

        h1,
        h2,
        h3,
        h4 {
            font-family: 'Outfit', sans-serif;
        }

        .glass-card {
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.1);
                opacity: 0.7;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .slot-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .slot-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.5);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.2);
        }
    </style>
</head>

<body class="min-h-screen overflow-x-hidden">
    <div id="app" class="flex flex-col lg:flex-row min-h-screen p-4 gap-4">
        <!-- Sidebar -->
        <aside class="w-full lg:w-72 glass-card rounded-3xl p-6 flex flex-col gap-8">
            <div class="flex items-center gap-3">
                <div class="p-2.5 bg-blue-600 rounded-xl shadow-lg shadow-blue-600/20">
                    <i data-lucide="car" class="text-white w-6 h-6"></i>
                </div>
                <h1 class="text-2xl font-bold tracking-tight">SmartPark <span class="text-blue-500">Pro</span></h1>
            </div>

            <nav class="flex flex-col gap-2">
                <button onclick="switchTab('dashboard')" id="nav-dashboard"
                    class="nav-btn active flex items-center gap-3 px-4 py-3.5 rounded-2xl transition-all bg-blue-600 text-white shadow-lg shadow-blue-900/20">
                    <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                    <span class="font-semibold">Dashboard</span>
                </button>
                <button onclick="switchTab('map')" id="nav-map"
                    class="nav-btn flex items-center gap-3 px-4 py-3.5 rounded-2xl transition-all text-gray-400 hover:bg-white/5 hover:text-white">
                    <i data-lucide="map" class="w-5 h-5"></i>
                    <span class="font-semibold">Parking Map</span>
                </button>
                <button onclick="switchTab('history')" id="nav-history"
                    class="nav-btn flex items-center gap-3 px-4 py-3.5 rounded-2xl transition-all text-gray-400 hover:bg-white/5 hover:text-white">
                    <i data-lucide="history" class="w-5 h-5"></i>
                    <span class="font-semibold">Activity Log</span>
                </button>
                <button onclick="switchTab('settings')" id="nav-settings"
                    class="nav-btn flex items-center gap-3 px-4 py-3.5 rounded-2xl transition-all text-gray-400 hover:bg-white/5 hover:text-white">
                    <i data-lucide="settings" class="w-5 h-5"></i>
                    <span class="font-semibold">Settings</span>
                </button>
            </nav>

            <div class="mt-auto p-5 glass-card bg-blue-600/5 border-blue-500/20 rounded-2xl">
                <p class="text-[10px] text-blue-400 font-bold tracking-widest uppercase mb-2">SYSTEM STATUS</p>
                <div class="flex items-center gap-3">
                    <div class="w-2.5 h-2.5 bg-green-500 rounded-full pulse shadow-[0_0_10px_rgba(34,197,94,0.5)]">
                    </div>
                    <span class="text-sm font-semibold">Operational</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col gap-8 p-2 lg:p-6 overflow-y-auto">
            <!-- Header -->
            <header class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
                <div>
                    <h2 class="text-3xl font-bold mb-1">Welcome back, Admin</h2>
                    <p class="text-gray-400 text-sm">Real-time parking intelligence at your fingertips.</p>
                </div>

                <div class="flex items-center gap-4 w-full md:w-auto">
                    <div class="relative flex-1 md:flex-none">
                        <i data-lucide="search"
                            class="absolute left-3.5 top-1/2 -translate-y-1/2 text-gray-500 w-4 h-4"></i>
                        <input type="text" id="search-input" placeholder="Search vehicle or slot..."
                            class="w-full md:w-72 bg-white/5 border border-white/10 rounded-2xl pl-10 pr-4 py-2.5 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all text-sm"
                            oninput="handleSearch(this.value)">
                    </div>
                    <button class="p-2.5 glass-card hover:bg-white/10 transition-all relative rounded-xl">
                        <i data-lucide="bell" class="w-5 h-5"></i>
                        <span
                            class="absolute top-2.5 right-2.5 w-2 h-2 bg-red-500 rounded-full border-2 border-[#0a0c10]"></span>
                    </button>
                    <div
                        class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center font-bold text-sm shadow-lg shadow-blue-500/20">
                        AD</div>
                </div>
            </header>

            <!-- Tabs Content -->
            <div id="tab-content">
                <!-- Dashboard Tab -->
                <div id="dashboard-view" class="tab-pane space-y-8">
                    <!-- Stats Grid -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="glass-card p-6 rounded-3xl flex items-center gap-5">
                            <div class="p-4 rounded-2xl bg-blue-500/10 text-blue-500">
                                <i data-lucide="car" class="w-7 h-7"></i>
                            </div>
                            <div>
                                <p class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1">Total Slots</p>
                                <h3 class="text-2xl font-bold" id="stat-total">24</h3>
                            </div>
                        </div>
                        <div class="glass-card p-6 rounded-3xl flex items-center gap-5">
                            <div class="p-4 rounded-2xl bg-green-500/10 text-green-500">
                                <i data-lucide="check-circle" class="w-7 h-7"></i>
                            </div>
                            <div>
                                <p class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1">Available</p>
                                <h3 class="text-2xl font-bold" id="stat-available">18</h3>
                            </div>
                        </div>
                        <div class="glass-card p-6 rounded-3xl flex items-center gap-5">
                            <div class="p-4 rounded-2xl bg-red-500/10 text-red-500">
                                <i data-lucide="clock" class="w-7 h-7"></i>
                            </div>
                            <div>
                                <p class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1">Occupied</p>
                                <h3 class="text-2xl font-bold" id="stat-occupied">6</h3>
                            </div>
                        </div>
                        <div class="glass-card p-6 rounded-3xl flex items-center gap-5">
                            <div class="p-4 rounded-2xl bg-purple-500/10 text-purple-500">
                                <i data-lucide="trending-up" class="w-7 h-7"></i>
                            </div>
                            <div>
                                <p class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1">Revenue</p>
                                <h3 class="text-2xl font-bold" id="stat-revenue">$90</h3>
                            </div>
                        </div>
                    </div>

                    <!-- Main Grid -->
                    <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
                        <div class="xl:col-span-2 glass-card p-8 rounded-3xl">
                            <div
                                class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8">
                                <h3 class="text-xl font-bold">Live Parking Grid</h3>
                                <div class="flex items-center gap-3 w-full sm:w-auto">
                                    <button onclick="downloadReport()"
                                        class="flex-1 sm:flex-none px-4 py-2.5 rounded-xl border border-white/10 hover:bg-white/5 transition-all flex items-center justify-center gap-2 text-sm font-semibold">
                                        <i data-lucide="download" class="w-4 h-4"></i>
                                        Export
                                    </button>
                                    <button onclick="openModal()"
                                        class="flex-1 sm:flex-none px-5 py-2.5 rounded-xl bg-blue-600 hover:bg-blue-500 text-white transition-all flex items-center justify-center gap-2 text-sm font-bold shadow-lg shadow-blue-600/20">
                                        <i data-lucide="plus" class="w-4 h-4"></i>
                                        New Booking
                                    </button>
                                </div>
                            </div>

                            <div id="parking-grid"
                                class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                                <!-- Slots injected here -->
                            </div>
                        </div>

                        <div class="glass-card p-8 rounded-3xl">
                            <h3 class="text-xl font-bold mb-6">Recent Activity</h3>
                            <div id="recent-activity" class="space-y-6">
                                <!-- Activity injected here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Map Tab -->
                <div id="map-view" class="tab-pane hidden space-y-8">
                    <div class="glass-card p-8 rounded-3xl">
                        <h3 class="text-2xl font-bold mb-8">Zone Distribution</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8" id="zone-grid">
                            <!-- Zones injected here -->
                        </div>
                    </div>
                </div>

                <!-- History Tab -->
                <div id="history-view" class="tab-pane hidden space-y-8">
                    <div class="glass-card p-8 rounded-3xl">
                        <div class="flex justify-between items-center mb-8">
                            <h3 class="text-2xl font-bold">Full Activity Log</h3>
                            <button onclick="clearLogs()"
                                class="text-sm text-red-500 hover:text-red-400 font-semibold">Clear All</button>
                        </div>
                        <div id="full-history" class="space-y-4">
                            <!-- History injected here -->
                        </div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div id="settings-view" class="tab-pane hidden space-y-8">
                    <div class="max-w-3xl space-y-6">
                        <div class="glass-card p-8 rounded-3xl flex items-center justify-between">
                            <div>
                                <h4 class="text-lg font-bold mb-1">Simulation Mode</h4>
                                <p class="text-sm text-gray-400">Automatically simulate parking traffic for demo
                                    purposes.</p>
                            </div>
                            <button id="sim-toggle" onclick="toggleSimulation()"
                                class="w-14 h-8 rounded-full bg-gray-700 relative transition-all duration-300">
                                <div
                                    class="absolute top-1 left-1 w-6 h-6 bg-white rounded-full transition-all duration-300 shadow-lg">
                                </div>
                            </button>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="glass-card p-8 rounded-3xl">
                                <h4 class="text-sm font-bold text-gray-400 uppercase tracking-widest mb-3">System
                                    Version</h4>
                                <p class="text-3xl font-bold text-blue-500">v2.4.0-pro</p>
                            </div>
                            <div class="glass-card p-8 rounded-3xl">
                                <h4 class="text-sm font-bold text-gray-400 uppercase tracking-widest mb-3">Last Backup
                                </h4>
                                <p class="text-lg font-semibold">Today, 04:20 AM</p>
                            </div>
                        </div>

                        <div class="glass-card p-8 rounded-3xl border-red-500/20 bg-red-500/5">
                            <h4 class="text-lg font-bold text-red-500 mb-2">Danger Zone</h4>
                            <p class="text-sm text-gray-400 mb-6">Resetting the system will clear all current sessions
                                and logs.</p>
                            <button onclick="resetSystem()"
                                class="px-6 py-3 bg-red-600 hover:bg-red-500 text-white rounded-xl font-bold transition-all shadow-lg shadow-red-600/20">
                                Reset All System Data
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Booking Modal -->
    <div id="booking-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-md" onclick="closeModal()"></div>
        <div class="glass-card w-full max-w-md p-8 rounded-3xl relative z-10 shadow-2xl">
            <h3 class="text-2xl font-bold mb-6">New Parking Session</h3>

            <div class="space-y-6">
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Vehicle Plate
                        Number</label>
                    <input type="text" id="modal-plate" placeholder="e.g. ABC-1234"
                        class="w-full bg-white/5 border border-white/10 rounded-2xl px-5 py-3.5 focus:outline-none focus:border-blue-500 transition-all">
                </div>

                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Vehicle
                        Type</label>
                    <div class="grid grid-cols-3 gap-3">
                        <button onclick="selectType('CAR')"
                            class="type-btn active p-4 rounded-2xl border-2 border-blue-600 bg-blue-600/10 text-blue-500 flex flex-col items-center gap-2 transition-all">
                            <i data-lucide="car" class="w-6 h-6"></i>
                            <span class="text-[10px] font-bold">CAR</span>
                        </button>
                        <button onclick="selectType('MOTORBIKE')"
                            class="type-btn p-4 rounded-2xl border-2 border-white/10 text-gray-500 hover:border-white/20 flex flex-col items-center gap-2 transition-all">
                            <i data-lucide="bike" class="w-6 h-6"></i>
                            <span class="text-[10px] font-bold">BIKE</span>
                        </button>
                        <button onclick="selectType('BUS')"
                            class="type-btn p-4 rounded-2xl border-2 border-white/10 text-gray-500 hover:border-white/20 flex flex-col items-center gap-2 transition-all">
                            <i data-lucide="bus" class="w-6 h-6"></i>
                            <span class="text-[10px] font-bold">BUS</span>
                        </button>
                    </div>
                </div>

                <div class="flex gap-4 pt-4">
                    <button onclick="closeModal()"
                        class="flex-1 py-3.5 rounded-2xl border border-white/10 font-bold hover:bg-white/5 transition-all">Cancel</button>
                    <button onclick="confirmBooking()"
                        class="flex-1 py-3.5 rounded-2xl bg-blue-600 hover:bg-blue-500 text-white font-bold transition-all shadow-lg shadow-blue-600/20">Confirm</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State Management
        let slots = [];
        let activityLog = [];
        let activeTab = 'dashboard';
        let isSimulationMode = false;
        let selectedType = 'CAR';
        let searchQuery = '';
        let simInterval = null;

        // Initialize Data
        function init() {
            const initialSlots = [];
            // Cars (101-112)
            for (let i = 1; i <= 12; i++) {
                initialSlots.push({
                    id: 100 + i,
                    type: 'CAR',
                    status: i % 4 === 0 ? 'OCCUPIED' : 'AVAILABLE',
                    occupiedBy: i % 4 === 0 ? `ABC-${1000 + i}` : null,
                    time: i % 4 === 0 ? '08:30 AM' : null
                });
            }
            // Bikes (201-208)
            for (let i = 1; i <= 8; i++) {
                initialSlots.push({
                    id: 200 + i,
                    type: 'MOTORBIKE',
                    status: i % 3 === 0 ? 'OCCUPIED' : 'AVAILABLE',
                    occupiedBy: i % 3 === 0 ? `BK-${200 + i}` : null,
                    time: i % 3 === 0 ? '09:15 AM' : null
                });
            }
            // Buses (301-304)
            for (let i = 1; i <= 4; i++) {
                initialSlots.push({
                    id: 300 + i,
                    type: 'BUS',
                    status: i === 1 ? 'OCCUPIED' : 'AVAILABLE',
                    occupiedBy: i === 1 ? `BUS-99` : null,
                    time: i === 1 ? '07:45 AM' : null
                });
            }
            slots = initialSlots;
            render();
            lucide.createIcons();
        }

        // Rendering Engine
        function render() {
            updateStats();
            renderGrid();
            renderActivity();
            renderMap();
            renderHistory();
        }

        function updateStats() {
            const total = slots.length;
            const available = slots.filter(s => s.status === 'AVAILABLE').length;
            const occupied = slots.filter(s => s.status === 'OCCUPIED').length;
            const revenue = occupied * 15;

            document.getElementById('stat-total').innerText = total;
            document.getElementById('stat-available').innerText = available;
            document.getElementById('stat-occupied').innerText = occupied;
            document.getElementById('stat-revenue').innerText = `$${revenue}`;
        }

        function renderGrid() {
            const grid = document.getElementById('parking-grid');
            const filtered = slots.filter(s =>
                s.id.toString().includes(searchQuery) ||
                (s.occupiedBy && s.occupiedBy.toLowerCase().includes(searchQuery.toLowerCase()))
            );

            grid.innerHTML = filtered.map(slot => `
                <div onclick="handleSlotClick(${slot.id})" class="slot-card p-5 rounded-2xl border-2 cursor-pointer relative overflow-hidden ${slot.status === 'AVAILABLE' ? 'border-green-500/20 bg-green-500/5' : 'border-red-500/20 bg-red-500/10'
                }">
                    <div class="absolute top-3 right-3 w-2 h-2 rounded-full ${slot.status === 'AVAILABLE' ? 'bg-green-500 shadow-[0_0_8px_#22c55e]' : 'bg-red-500 shadow-[0_0_8px_#ef4444]'
                }"></div>
                    <span class="block text-xl font-black mb-1">${slot.id}</span>
                    <span class="block text-[10px] font-bold text-gray-500 uppercase tracking-widest">${slot.type}</span>
                    ${slot.occupiedBy ? `<div class="mt-3 pt-3 border-t border-white/5 text-[10px] font-mono text-blue-400 truncate">${slot.occupiedBy}</div>` : ''}
                </div>
            `).join('');
        }

        function renderActivity() {
            const container = document.getElementById('recent-activity');
            const activeSessions = slots.filter(s => s.status === 'OCCUPIED').slice(0, 5);

            if (activeSessions.length === 0) {
                container.innerHTML = '<div class="text-center py-10 text-gray-500 text-sm">No active sessions</div>';
                return;
            }

            container.innerHTML = activeSessions.map(s => `
                <div class="flex items-center gap-4">
                    <div class="w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center shrink-0">
                        <i data-lucide="${s.type === 'CAR' ? 'car' : s.type === 'MOTORBIKE' ? 'bike' : 'bus'}" class="w-5 h-5 text-gray-400"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-bold truncate">Vehicle ${s.occupiedBy}</p>
                        <p class="text-[10px] text-gray-500 uppercase font-bold tracking-tighter">Slot ${s.id} • ${s.time || 'Just now'}</p>
                    </div>
                    <div class="text-green-500">
                        <i data-lucide="check-circle" class="w-4 h-4"></i>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        function renderMap() {
            const container = document.getElementById('zone-grid');
            const types = ['CAR', 'MOTORBIKE', 'BUS'];

            container.innerHTML = types.map(type => `
                <div class="space-y-4">
                    <div class="flex items-center gap-2 mb-4">
                        <i data-lucide="${type === 'CAR' ? 'car' : type === 'MOTORBIKE' ? 'bike' : 'bus'}" class="w-5 h-5 text-blue-500"></i>
                        <h4 class="font-bold uppercase tracking-widest text-sm">${type} Zone</h4>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        ${slots.filter(s => s.type === type).map(s => `
                            <div class="p-3 rounded-xl border border-white/10 bg-white/5 flex justify-between items-center">
                                <span class="font-bold text-sm">${s.id}</span>
                                <div class="w-2 h-2 rounded-full ${s.status === 'AVAILABLE' ? 'bg-green-500' : 'bg-red-500'}"></div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        function renderHistory() {
            const container = document.getElementById('full-history');
            if (activityLog.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-20 text-gray-600">
                        <i data-lucide="history" class="w-12 h-12 mx-auto mb-4 opacity-20"></i>
                        <p>No activity recorded yet.</p>
                    </div>
                `;
                lucide.createIcons();
                return;
            }

            container.innerHTML = activityLog.map(log => `
                <div class="flex items-center justify-between p-4 bg-white/5 rounded-2xl border border-white/10">
                    <div class="flex items-center gap-4">
                        <div class="p-2.5 rounded-xl ${log.action === 'PARKED' ? 'bg-green-500/10 text-green-500' : 'bg-red-500/10 text-red-500'}">
                            <i data-lucide="${log.action === 'PARKED' ? 'plus' : 'log-out'}" class="w-5 h-5"></i>
                        </div>
                        <div>
                            <p class="font-bold text-sm">Vehicle ${log.vehicleId} ${log.action.toLowerCase()}</p>
                            <p class="text-[10px] text-gray-500 font-bold uppercase tracking-widest">Slot ${log.id} • ${log.type}</p>
                        </div>
                    </div>
                    <span class="text-xs font-mono text-gray-500">${log.time}</span>
                </div>
            `).join('');
            lucide.createIcons();
        }

        // Actions
        function switchTab(tabId) {
            activeTab = tabId;
            document.querySelectorAll('.tab-pane').forEach(el => el.classList.add('hidden'));
            document.getElementById(`${tabId}-view`).classList.remove('hidden');

            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white', 'shadow-lg', 'shadow-blue-900/20');
                btn.classList.add('text-gray-400', 'hover:bg-white/5', 'hover:text-white');
            });

            const activeBtn = document.getElementById(`nav-${tabId}`);
            activeBtn.classList.remove('text-gray-400', 'hover:bg-white/5', 'hover:text-white');
            activeBtn.classList.add('bg-blue-600', 'text-white', 'shadow-lg', 'shadow-blue-900/20');

            render();
        }

        function handleSearch(val) {
            searchQuery = val;
            renderGrid();
        }

        function handleSlotClick(id) {
            const slot = slots.find(s => s.id === id);
            if (slot.status === 'OCCUPIED') {
                if (confirm(`Release slot ${id} (Vehicle: ${slot.occupiedBy})?`)) {
                    releaseSlot(id);
                }
            }
        }

        function releaseSlot(id) {
            const slot = slots.find(s => s.id === id);
            const vehicleId = slot.occupiedBy;
            slot.status = 'AVAILABLE';
            slot.occupiedBy = null;
            slot.time = null;

            activityLog.unshift({
                id,
                type: slot.type,
                action: 'RELEASED',
                vehicleId,
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
            });

            render();
        }

        function openModal() {
            document.getElementById('booking-modal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('booking-modal').classList.add('hidden');
            document.getElementById('modal-plate').value = '';
        }

        function selectType(type) {
            selectedType = type;
            document.querySelectorAll('.type-btn').forEach(btn => {
                btn.classList.remove('active', 'border-blue-600', 'bg-blue-600/10', 'text-blue-500');
                btn.classList.add('border-white/10', 'text-gray-500');
            });
            const activeBtn = Array.from(document.querySelectorAll('.type-btn')).find(b => b.innerText.includes(type));
            activeBtn.classList.add('active', 'border-blue-600', 'bg-blue-600/10', 'text-blue-500');
            activeBtn.classList.remove('border-white/10', 'text-gray-500');
        }

        function confirmBooking() {
            const plate = document.getElementById('modal-plate').value.trim();
            if (!plate) return alert('Enter plate number');

            const availableSlot = slots.find(s => s.type === selectedType && s.status === 'AVAILABLE');
            if (!availableSlot) return alert(`No available slots for ${selectedType}`);

            availableSlot.status = 'OCCUPIED';
            availableSlot.occupiedBy = plate;
            availableSlot.time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

            activityLog.unshift({
                id: availableSlot.id,
                type: selectedType,
                action: 'PARKED',
                vehicleId: plate,
                time: availableSlot.time
            });

            closeModal();
            render();
        }

        function toggleSimulation() {
            isSimulationMode = !isSimulationMode;
            const btn = document.getElementById('sim-toggle');
            const dot = btn.querySelector('div');

            if (isSimulationMode) {
                btn.classList.replace('bg-gray-700', 'bg-blue-600');
                dot.classList.replace('left-1', 'left-7');
                startSimulation();
            } else {
                btn.classList.replace('bg-blue-600', 'bg-gray-700');
                dot.classList.replace('left-7', 'left-1');
                stopSimulation();
            }
        }

        function startSimulation() {
            simInterval = setInterval(() => {
                const action = Math.random() > 0.6 ? 'PARK' : 'RELEASE';
                if (action === 'PARK') {
                    const available = slots.filter(s => s.status === 'AVAILABLE');
                    if (available.length > 0) {
                        const slot = available[Math.floor(Math.random() * available.length)];
                        const plate = `SIM-${Math.floor(1000 + Math.random() * 9000)}`;
                        slot.status = 'OCCUPIED';
                        slot.occupiedBy = plate;
                        slot.time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                        activityLog.unshift({
                            id: slot.id,
                            type: slot.type,
                            action: 'PARKED',
                            vehicleId: plate,
                            time: slot.time
                        });
                    }
                } else {
                    const occupied = slots.filter(s => s.status === 'OCCUPIED');
                    if (occupied.length > 0) {
                        const slot = occupied[Math.floor(Math.random() * occupied.length)];
                        releaseSlot(slot.id);
                    }
                }
                render();
            }, 3000);
        }

        function stopSimulation() {
            clearInterval(simInterval);
        }

        function downloadReport() {
            const csv = "Slot ID,Type,Status,Occupied By,Time\n" +
                slots.map(s => `${s.id},${s.type},${s.status},${s.occupiedBy || 'N/A'},${s.time || 'N/A'}`).join("\n");
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', 'parking_report.csv');
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function clearLogs() {
            if (confirm('Clear all activity logs?')) {
                activityLog = [];
                render();
            }
        }

        function resetSystem() {
            if (confirm('CRITICAL: This will clear all sessions and logs. Continue?')) {
                activityLog = [];
                slots.forEach(s => {
                    s.status = 'AVAILABLE';
                    s.occupiedBy = null;
                    s.time = null;
                });
                render();
            }
        }

        // Start
        init();
    </script>
</body>

</html>